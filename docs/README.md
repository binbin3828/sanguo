# 三国霸业 - 游戏功能设计文档集

## 文档概述

本文档集是对原版C++像素风格《三国霸业》战旗游戏的完整功能拆解，用于指导使用HTML+JS技术栈进行现代化重构开发。

**核心原则**：保留原游戏所有玩法逻辑、数值系统和算法，仅将UI从像素风格升级为现代界面。

---

## 文档结构

### 核心文档

1. **01-游戏总体概述.md**
   - 游戏类型与背景
   - 核心玩法循环
   - 游戏模块划分
   - 关键数据结构定义（武将、城市、道具、命令等）
   - 核心常量定义（兵种、地形、状态、性格等）
   - 引擎配置参数

2. **02-内政系统详细设计.md**
   - 14条内政指令详细逻辑
   - 指令执行系统
   - 城市状态系统（灾害、资源增长）
   - 交互流程设计
   - 数据持久化

3. **03-外交系统详细设计.md**
   - 5条外交指令详细逻辑（离间、招揽、策反、反间、劝降）
   - 成功率计算公式
   - 对话系统
   - AI外交行为

4. **04-战斗系统详细设计.md**
   - 战斗触发与流程
   - 地图系统与地形
   - 行军路径算法（BFS）
   - 攻击与防御计算
   - 技能系统
   - 天气系统
   - 粮草消耗
   - 战斗AI系统
   - 经验与升级

5. **05-数值计算与公式汇总.md**
   - 武将属性计算公式
   - 战斗伤害计算公式
   - 外交成功率公式
   - 内政数值公式
   - 资源计算公式
   - 随机事件概率
   - 默认配置参数
   - 常量汇总表

6. **06-游戏数据配置与静态资源.md**
   - 数据文件组织结构
   - 城池数据配置（38座城列表）
   - 武将数据配置（著名武将属性）
   - 历史时期配置（4个时期）
   - 道具数据配置
   - 技能数据配置
   - 地图配置
   - JSON配置示例
   - 数据加载流程

7. **07-游戏数据配置说明.md** ⭐ NEW
   - 完整的数据配置文件说明
   - 38座城池详细数据
   - 200名武将完整属性
   - 4个历史时期初始设置
   - 16种技能详细参数
   - 24种道具数据
   - 数据使用指南
   - 扩展和修改建议

---

## 游戏核心数据

完整的数据配置位于 `data/dat.xml`，详细说明请参考**07-游戏数据配置说明.md**。

### 城池数据（38座）
- **超级城市**：洛阳、成都（农业/商业上限≥900）
- **大城市**：长安、许昌、邺、建业、襄阳等
- **中等城市**：下邳、寿春、南皮等
- **边陲城市**：北平、云南、武威等
- **包含属性**：农业上限、商业上限、人口上限、相邻城市连接

### 武将数据（200名）
- **君主**：董卓、曹操、刘备、孙权、袁绍等10+位
- **顶级武将**：
  - 武力100：吕布
  - 武力97-98：张飞、关羽、马超
  - 武力96：赵云、典韦、许褚
- **顶级谋士**：
  - 智力100：诸葛亮
  - 智力98：司马懿、庞统、郭嘉
  - 智力97：周瑜
- **属性**：武力、智力、性格、兵种、特有技能

### 历史时期（4个）
1. **董卓弄权**（189年）- 董卓最强，吕布在麾下
2. **曹操崛起**（196年）- 曹操迎献帝，势力大增
3. **赤壁之战**（208年）- 诸葛亮登场，三强鼎立
4. **三国鼎立**（220年）- 魏蜀吴三国正式成立

### 道具数据（24种）
- **武器**（8种）：方天画戟(+18)、青龙偃月刀(+15)等
- **防具**（4种）：黄金铠(+30%)、白银铠(+20%)等
- **坐骑**（4种）：赤兔马(+3移动力)、的卢(+2)等
- **兵书**（4种）：遁甲天书(+15智)、孙子兵法(+10智)等

### 技能数据（16种）
- **攻击类**：火攻、水淹、滚木、落石、陷阱
- **控制类**：混乱、定身、禁咒、石阵
- **辅助类**：援兵、援军、奇门、遁甲、潜踪
- **特殊**：流言、天变（君主特有）

---

## 技术重构建议

### 前端技术栈
- **框架**：Vue 3 / React / 原生JavaScript
- **渲染**：Canvas API / WebGL (推荐PixiJS)
- **状态管理**：Pinia / Redux / 自定义
- **资源管理**：自定义资源加载器

### 数据管理
- 使用JSON存储配置数据（参考文档06的JSON示例）
- LocalStorage/IndexedDB实现存档
- TypeScript提供类型安全

### 渲染架构
- 地图层：背景、地形
- 单位层：城市、武将
- UI层：菜单、面板、对话框
- 特效层：动画、粒子

### 需保留的核心算法
1. 行军路径计算（BFS算法）
2. 战斗伤害计算
3. 成功率计算（外交）
4. 经验升级系统
5. AI决策树

---

## 文档使用指南

### 对于开发者
1. **第一步**：阅读**01-游戏总体概述.md**了解整体架构
2. **第二步**：查看**07-游戏数据配置说明.md**了解完整数据
3. **第三步**：参考**06-游戏数据配置与静态资源.md**理解数据格式
4. **第四步**：根据开发模块查阅对应系统文档（02-05）
5. **第五步**：参考**05-数值计算与公式汇总.md**实现数值系统
6. **开发时**：直接使用`data/dat.xml`作为数据源

### 对于策划
1. **查看完整数据**：**07-游戏数据配置说明.md**包含所有武将、城市、道具的详细数据
2. **调整数值**：修改`data/dat.xml`文件
3. **平衡性调整**：参考**05-数值计算与公式汇总.md**修改公式参数
4. **添加内容**：按照07文档中的格式添加新武将、新城市

### 对于美术
- 原游戏为像素风格（16x16图块）
- 重构目标为现代UI风格
- 需要设计：城市图标、武将头像、兵种图标、技能图标等

---

## 版本历史

- **v1.1** (2026-02-10)
  - 新增**07-游戏数据配置说明.md**
  - 创建完整数据配置文件`data/dat.xml`
  - 包含38座城池、200名武将、4个时期、16种技能、24种道具
  - 可直接用于游戏开发

- **v1.0** (2026-02-10)
  - 基于C++源代码分析完成
  - 包含6个核心文档
  - 覆盖游戏全部系统和数据逻辑

---

## 注意事项

1. **数据文件**：`data/dat.xml`是完整的游戏数据配置，开发时直接加载此文件。

2. **数值精确性**：本文档基于源代码逆向分析，所有公式和数值都经过验证。

3. **数据完整性**：文档06提供了数据格式说明。

4. **兼容性**：重构时保持数值一致可确保游戏平衡性不变。

5. **扩展性**：可通过修改JSON文件添加新武将、新城市，格式参考07文档。

6. **AI行为**：战斗AI和外交AI的决策逻辑需严格按文档02-04实现。

---

*文档创建：2026-02-10*  
*基于：三国霸业C++源代码（步步高电子词典版）*
