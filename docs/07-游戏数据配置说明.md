# 三国霸业 - 游戏数据配置说明文档

## 文档说明

本文档详细说明《三国霸业》游戏的所有静态数据配置，包括城池、武将、道具、技能等。这些数据存储在 `data/dat.xml` 文件中，用于游戏初始化加载。

---

## 一、数据文件结构

### 1.1 文件位置
```
data/
└── data/dat.xml    # 主配置文件
```

### 1.2 JSON结构概览
```json
{
  "metadata": {         // 元数据信息
  "cities": [...],      // 38座城池基础数据
  "persons": [...],     // 200名武将完整数据
  "periods": [...],     // 4个历史时期初始配置
  "skills": [...],      // 16种技能数据
  "goods": [...]        // 24种道具数据
}
```

---

## 二、城池数据（cities）

### 2.1 数据结构
```typescript
interface City {
  // 基础属性（静态配置）
  id: number;                    // 城市编号（0-37）
  name: string;                  // 城市名称
  position: {x: number, y: number};  // 战略地图坐标
  farmingLimit: number;          // 农业开发上限（500-1000）
  commerceLimit: number;         // 商业开发上限（400-1000）
  populationLimit: number;       // 人口上限（150000-600000）
  connections: number[];         // 相邻城市ID列表
  
  // 运行时属性（动态变化）
  state: number;                 // 城市状态（0=正常,1=饥荒,2=旱灾,3=水灾,4=暴动）
  belong: number;                // 归属势力（武将ID+1，0=无主）
  satrapId: number;              // 太守编号（武将ID+1）
  farming: number;               // 当前农业开发度（0-farmingLimit）
  commerce: number;              // 当前商业开发度（0-commerceLimit）
  peopleDevotion: number;        // 民忠（0-100）
  avoidCalamity: number;         // 防灾值（0-100）
  population: number;            // 当前人口（0-populationLimit）
  money: number;                 // 金钱（0-65535）
  food: number;                  // 粮食（0-65535）
  mothballArms: number;          // 后备兵力（0-65535）
  persons: number;               // 城中武将数
  tools: number;                 // 城中道具数
}
```

**注意**：游戏支持最大城市数256座（0-255），本配置文件提供38座主要城市。

### 2.2 城市分类

#### 核心城市（农业/商业上限 ≥ 900）
| 编号 | 名称 | 农业上限 | 商业上限 | 特点 |
|------|------|----------|----------|------|
| 10 | 洛阳 | 1000 | 1000 | 都城，资源丰富 |
| 7 | 邺 | 1000 | 900 | 河北重镇 |
| 13 | 许昌 | 950 | 900 | 中原核心 |
| 23 | 成都 | 1000 | 900 | 蜀地中心 |
| 34 | 建业 | 950 | 900 | 吴国都城 |

#### 中等城市（500-800）
- 长安、襄阳、寿春、下邳、南皮等

#### 边陲城市（< 600）
- 襄平、云南、建宁、武威等（地理位置偏远，资源较少）

### 2.3 城市连接关系

```typescript
// 示例：洛阳的连接
{
  id: 10,
  name: "洛阳",
  connections: [9, 11, 13, 18]  // 陈留、长安、许昌、濮阳
}
```

**战略意义**：
- 洛阳是交通中心，连接4座城市
- 汉中连接天水、成都，是入蜀要道
- 江陵连接襄阳、长沙，是荆州核心

---

## 三、武将数据（persons）

### 3.1 数据结构
```typescript
interface Person {
  id: number;           // 武将编号（0-199）
  name: string;         // 姓名
  force: number;        // 武力（0-100）
  iq: number;           // 智力（0-100）
  character: number;    // 性格（0-4）
  armyType: number;     // 兵种（0-5）
  specialSkill: number; // 特有技能ID
  isKing: boolean;      // 是否君主
  
  // 运行时属性（初始值）
  level: number;        // 等级（1-20，默认1）
  age: number;          // 年龄（默认16-60）
  devotion: number;     // 忠诚度（0-100，默认70-100）
  experience: number;   // 经验值（0-99，默认0）
  thew: number;         // 体力（0-100，默认100）
  arms: number;         // 兵力（0-max，默认0）
  equip: number[];      // 装备道具ID[2]（默认[0,0]）
}
```

**注意**：游戏引擎支持最大武将数2000人，但本配置文件提供200名主要武将。如需扩展，可按相同格式添加。

### 3.2 性格类型

| 编号 | 性格 | 离间成功率 | 招揽成功率 | 策反成功率 | 招降成功率 |
|------|------|------------|------------|------------|------------|
| 0 | 卤莽 | 50% | 15% | 30% | 15% |
| 1 | 怕死 | 30% | 40% | 10% | 60% |
| 2 | 贪财 | 40% | 30% | 20% | 30% |
| 3 | 大志 | 30% | 20% | 60% | 20% |
| 4 | 忠义 | 5% | 5% | 5% | 5% |

### 3.3 兵种类型

| 编号 | 兵种 | 基础移动力 | 特点 |
|------|------|------------|------|
| 0 | 骑兵 | 5 | 攻击力强，适合平原 |
| 1 | 步兵 | 4 | 防御力高，山地优势 |
| 2 | 弓箭兵 | 4 | 远程攻击，森林优势 |
| 3 | 水军 | 5 | 水战专家 |
| 4 | 极兵 | 6 | 全能型，各项均衡 |
| 5 | 玄兵 | 3 | 擅长计谋，移动力低 |

### 3.4 顶级武将列表

#### 武力排行榜
| 排名 | 姓名 | 武力 | 势力 | 特点 |
|------|------|------|------|------|
| 1 | 吕布 | 100 | 董卓 | 天下无双 |
| 2 | 张飞 | 98 | 刘备 | 万人敌 |
| 3 | 关羽 | 97 | 刘备 | 武圣 |
| 3 | 马超 | 97 | 刘备 | 锦马超 |
| 5 | 赵云 | 96 | 刘备 | 常胜将军 |
| 6 | 典韦 | 95 | 曹操 | 古之恶来 |
| 6 | 许褚 | 96 | 曹操 | 虎痴 |

#### 智力排行榜
| 排名 | 姓名 | 智力 | 势力 | 特点 |
|------|------|------|------|------|
| 1 | 诸葛亮 | 100 | 刘备 | 卧龙 |
| 2 | 司马懿 | 98 | 曹操 | 冢虎 |
| 3 | 庞统 | 98 | 刘备 | 凤雏 |
| 4 | 周瑜 | 97 | 孙权 | 美周郎 |
| 5 | 郭嘉 | 98 | 曹操 | 鬼才 |

#### 文武双全
| 姓名 | 武力 | 智力 | 势力 |
|------|------|------|------|
| 关羽 | 97 | 82 | 蜀汉 |
| 赵云 | 96 | 80 | 蜀汉 |
| 张辽 | 92 | 78 | 曹魏 |
| 姜维 | 92 | 90 | 蜀汉 |
| 邓艾 | 88 | 90 | 曹魏 |

### 3.5 势力分布

#### 曹魏势力（35人）
**君主**：曹操（武力87，智力91）

**五子良将**：
- 张辽（92/78）- 骑兵
- 徐晃（89/76）- 骑兵
- 张郃（89/74）- 骑兵
- 于禁（83/72）- 步兵
- 乐进（84/68）- 步兵

**谋士团**：
- 郭嘉（48/98）- 玄兵
- 荀彧（46/95）- 玄兵
- 荀攸（44/94）- 玄兵
- 程昱（58/92）- 玄兵
- 贾诩（56/97）- 玄兵

#### 蜀汉势力（30人）
**君主**：刘备（75/76）

**五虎上将**：
- 关羽（97/82）- 骑兵
- 张飞（98/35）- 步兵
- 赵云（96/80）- 骑兵
- 马超（97/48）- 骑兵
- 黄忠（93/62）- 弓兵

**军师**：
- 诸葛亮（62/100）- 玄兵，特有技能：天变
- 庞统（58/98）- 玄兵
- 徐庶（65/94）- 玄兵
- 法正（62/94）- 玄兵

#### 东吴势力（30人）
**君主**：孙权（78/85）

**四大都督**：
- 周瑜（71/97）- 水军，特有技能：天变
- 鲁肃（62/92）- 玄兵
- 吕蒙（82/90）- 步兵
- 陆逊（68/95）- 水军

**猛将**：
- 太史慈（93/68）- 骑兵
- 甘宁（94/78）- 水军
- 周泰（88/62）- 步兵
- 凌统（86/65）- 水军

#### 其他势力
- **董卓势力**：吕布、李儒、华雄等
- **袁绍势力**：颜良、文丑、田丰、沮授等
- **刘表势力**：文聘、蔡瑁等
- **马腾势力**：马超、马岱、庞德等

---

## 四、历史时期配置（periods）

### 4.1 时期1：董卓弄权（189年）

#### 势力分布
| 城市 | 势力 | 君主 | 初始兵力 |
|------|------|------|----------|
| 洛阳、长安 | 董卓 | 董卓 | 5000 |
| 南皮、邺 | 袁绍 | 袁绍 | 4000 |
| 陈留 | 曹操 | 曹操 | 3500 |
| 平原 | 刘备 | 刘备 | 2500 |
| 长沙 | 孙坚 | 孙坚 | 3000 |
| 襄阳、江陵、江夏 | 刘表 | 刘表 | 4000 |
| 天水、武威 | 马腾 | 马腾 | 2500 |
| 北平 | 公孙瓒 | 公孙瓒 | 2600 |

#### 特色设定
- **吕布在董卓麾下**：尚未独立
- **诸葛亮未登场**：需等到赤壁之战时期
- **黄巾军已灭**：张角等作为在野武将

### 4.2 时期2：曹操崛起（196年）

#### 势力变化
- **曹操**：迎献帝于许昌，势力大增
- **吕布**：占据濮阳，与曹操对峙
- **刘备**：暂居曹操麾下
- **孙策**：统一江东

#### 新增武将
- 谋士：荀彧、荀攸、程昱等加入曹操
- 武将：张辽、高顺等原吕布部下可招揽

### 4.3 时期3：赤壁之战（208年）

#### 势力分布
- **曹操**：北方大部分地区，兵力最强
- **刘备**：江夏、部分荆州，诸葛亮登场
- **孙权**：江东全境，周瑜为都督
- **刘璋**：益州，可招揽
- **张鲁**：汉中

#### 特色武将登场
- **诸葛亮**：在野，可通过搜索获得（智力100）
- **庞统**：在野，可通过搜索获得（智力98）
- **徐庶**：在野，可通过搜索获得（智力94）

### 4.4 时期4：三国鼎立（220年）

#### 势力分布
- **曹魏**：曹丕继位，占中原
- **蜀汉**：刘备称帝，占益州、汉中
- **东吴**：孙权称帝，占江东、荆州南部

#### 新增武将
- **姜维**：蜀汉后期主力（武力92，智力90）
- **邓艾、钟会**：曹魏后期名将
- **陆抗**：东吴名将陆逊之子

---

## 五、技能数据（skills）

### 5.1 技能分类

#### 攻击类技能
| ID | 名称 | 伤害 | MP | 说明 |
|----|------|------|-----|------|
| 1 | 火攻 | 150 | 20 | 火系伤害，风天增强 |
| 2 | 水淹 | 140 | 20 | 水系伤害，雨天增强 |
| 3 | 滚木 | 120 | 15 | 木系伤害，山地增强 |
| 4 | 落石 | 130 | 15 | 石系伤害，山地增强 |
| 15 | 陷阱 | 80 | 15 | 设置陷阱 |

#### 控制类技能
| ID | 名称 | MP | 效果 | 说明 |
|----|------|-----|------|------|
| 5 | 混乱 | 25 | 混乱 | 随机移动，无法攻击 |
| 6 | 定身 | 25 | 定身 | 移动力降为1 |
| 7 | 禁咒 | 30 | 禁咒 | 无法使用技能 |
| 10 | 石阵 | 25 | 石阵 | 每回合损失兵力 |

#### 辅助类技能
| ID | 名称 | MP | 效果 | 说明 |
|----|------|-----|------|------|
| 8 | 奇门 | 20 | 奇门 | 可穿过敌方 |
| 9 | 遁甲 | 20 | 遁甲 | 免疫某些攻击 |
| 11 | 潜踪 | 25 | 潜踪 | 隐身效果 |
| 12 | 援兵 | 30 | 恢复 | 恢复100兵力 |
| 13 | 援军 | 40 | 恢复 | 恢复200兵力 |

#### 特殊技能
| ID | 名称 | MP | 效果 | 说明 |
|----|------|-----|------|------|
| 14 | 流言 | 20 | 降忠 | 降低敌方忠诚度 |
| 29 | 天变 | 50 | 天气 | 改变天气，君主特有 |

### 5.2 技能获取规则

**兵种技能数量**：
- 骑兵：3个技能
- 步兵：4个技能
- 弓箭兵：3个技能
- 水军：3个技能
- 极兵：4个技能
- 玄兵：9个技能（最多）

**等级与技能**：
```
技能数量 = floor(该兵种技能总数 × 当前等级 / 最大等级) + 1
```

**君主特有**：
- 所有君主额外学会技能29（天变）

---

## 六、道具数据（goods）

### 6.1 武器类（8种）

| ID | 名称 | 武力+ | 智力+ | 移动力+ | 说明 |
|----|------|-------|-------|---------|------|
| 1 | 青釭剑 | 10 | 0 | 0 | 曹操佩剑 |
| 2 | 倚天剑 | 12 | 0 | 0 | 绝世好剑 |
| 3 | 雌雄双股剑 | 8 | 2 | 0 | 刘备佩剑 |
| 4 | 青龙偃月刀 | 15 | 0 | 0 | 关羽兵器 |
| 5 | 丈八蛇矛 | 14 | 0 | 0 | 张飞兵器 |
| 6 | 方天画戟 | 18 | 0 | 0 | 吕布兵器，最强武器 |
| 7 | 吕布之弓 | 10 | 0 | 0 | 远程武器 |
| 8 | 李广之弓 | 12 | 0 | 0 | 神射手之弓 |

### 6.2 防具类（4种）

| ID | 名称 | 防御加成 | 说明 |
|----|------|----------|------|
| 20 | 白银铠 | +20% | 白银打造 |
| 21 | 黄金铠 | +30% | 黄金打造，最强防具 |
| 22 | 铁铠 | +15% | 铁制铠甲 |
| 23 | 皮铠 | +10% | 皮制铠甲 |

### 6.3 坐骑类（4种）

| ID | 名称 | 移动力+ | 说明 |
|----|------|---------|------|
| 40 | 赤兔马 | +3 | 吕布、关羽坐骑 |
| 41 | 的卢 | +2 | 刘备坐骑 |
| 42 | 爪黄飞电 | +2 | 曹操坐骑 |
| 43 | 绝影 | +2 | 曹操坐骑 |

### 6.4 兵书类（4种）

| ID | 名称 | 智力+ | 说明 |
|----|------|-------|------|
| 60 | 孙子兵法 | +10 | 孙武所著 |
| 61 | 孟德新书 | +8 | 曹操所著 |
| 62 | 太平要术 | +12 | 张角所得 |
| 63 | 遁甲天书 | +15 | 左慈传授，最强兵书 |

---

## 七、数据使用指南

### 7.1 加载游戏数据

```javascript
// 加载JSON配置
async function loadGameData() {
  const response = await fetch('data/dat.xml');
  const data = await response.json();
  
  return {
    cities: data.cities,
    persons: data.persons,
    periods: data.periods,
    skills: data.skills,
    goods: data.goods
  };
}
```

### 7.2 初始化时期数据

```javascript
function initPeriod(periodId) {
  const period = gameData.periods.find(p => p.id === periodId);
  
  // 初始化城市
  period.initialSetup.cities.forEach(citySetup => {
    const city = gameData.cities.find(c => c.id === citySetup.cityId);
    // 设置初始值
    city.belong = citySetup.belong;
    city.farming = citySetup.farming;
    city.commerce = citySetup.commerce;
    city.population = citySetup.population;
    city.money = citySetup.money;
    city.food = citySetup.food;
  });
  
  // 初始化武将
  period.initialSetup.persons.forEach(personSetup => {
    const person = gameData.persons.find(p => p.id === personSetup.personId);
    person.belong = personSetup.belong;
    person.cityId = personSetup.cityId;
    if (personSetup.level) {
      person.level = personSetup.level;
    }
  });
}
```

### 7.3 扩展数据

如需添加新武将，按照以下格式：

```json
{
  "id": 200,
  "name": "新武将",
  "force": 80,
  "iq": 70,
  "character": 4,
  "armyType": 0,
  "specialSkill": 0,
  "isKing": false
}
```

---

## 八、数据平衡性说明

### 8.1 武将属性范围
- **武力**：25-100（貂蝉25，吕布100）
- **智力**：25-100（貂蝉85，诸葛亮100）
- **等级**：1-20级
- **忠诚**：0-100

### 8.2 城市资源平衡
- **超级城市**（洛阳、成都）：人口上限50-60万
- **大城市**（许昌、邺、建业）：人口上限40-50万
- **中等城市**：人口上限25-40万
- **边陲城市**：人口上限15-25万

### 8.3 势力平衡
- **董卓弄权时期**：董卓最强，占据两座大城
- **曹操崛起时期**：曹操、袁绍实力相当
- **赤壁之战时期**：曹操最强，孙刘联盟
- **三国鼎立时期**：三方势力相对均衡

---

## 九、修改建议

### 9.1 调整武将属性
如需修改某武将的属性，直接在JSON中找到对应ID修改即可。

### 9.2 添加新城市
在`cities`数组中添加新城市对象，注意：
- ID要唯一
- 设置合理的连接关系
- 调整战略地图坐标

### 9.3 修改时期配置
可以在`periods`中调整：
- 初始城市归属
- 初始资源数量
- 武将初始位置

---

*文档版本：1.0*
*配套数据：data/dat.xml*
*创建日期：2026-02-10*
